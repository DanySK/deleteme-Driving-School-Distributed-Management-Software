FROM gradle:8.1.1-jdk17
WORKDIR /app

COPY ./build/output/DoctorService-SNAPSHOT.jar .

ARG MONGO_URI
ENV MONGO_URI="-Dmongo_uri=${MONGO_URI}"

ARG DOCTOR_PORT
ENV DOCTOR_PORT="-Ddoctor_port=${DOCTOR_PORT}"

ARG DOSSIER_SERVICE_HOST=localhost
ENV DOSSIER_HOST_ARG="-Ddossier_host=${DOSSIER_SERVICE_HOST}"

ARG DOSSIER_SERVICE_PORT
ENV DOSSIER_SERVICE_PORT="-Ddossier_port=${DOSSIER_SERVICE_PORT}"

ARG EXAM_SERVICE_HOST=localhost
ENV EXAM_SERVICE_HOST="-Dexam_host=${EXAM_SERVICE_HOST}"

ARG EXAM_SERVICE_PORT
ENV EXAM_SERVICE_PORT="-Dexam_port=${EXAM_SERVICE_PORT}"


CMD java \
    $DOSSIER_HOST_ARG $DOSSIER_SERVICE_PORT \
    $EXAM_SERVICE_HOST $EXAM_SERVICE_PORT \
    $MONGO_URI $DOCTOR_PORT -jar DoctorService-SNAPSHOT.jar