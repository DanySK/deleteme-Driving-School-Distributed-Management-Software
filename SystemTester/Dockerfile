FROM gradle:8.1.1-jdk17
WORKDIR /app
COPY ./build/output/SystemTester-SNAPSHOT.jar .

ARG DOSSIER_SERVICE_HOST=localhost
ENV DOSSIER_HOST_ARG="-Ddossier_host=${DOSSIER_SERVICE_HOST}"

ARG DRIVING_SERVICE_HOST=localhost
ENV DRIVING_HOST_ARG="-Ddriving_host=${DRIVING_SERVICE_HOST}"

ARG DOSSIER_SERVICE_PORT
ENV DOSSIER_SERVICE_PORT="-Ddossier_port=${DOSSIER_SERVICE_PORT}"

ARG DRIVING_SERVICE_PORT
ENV DRIVING_SERVICE_PORT="-Ddriving_port=${DRIVING_SERVICE_PORT}"

CMD java $DOSSIER_HOST_ARG $DRIVING_HOST_ARG $DOSSIER_SERVICE_PORT $DRIVING_SERVICE_PORT -jar SystemTester-SNAPSHOT.jar