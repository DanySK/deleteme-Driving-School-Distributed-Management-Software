FROM gradle:8.1.1-jdk17
WORKDIR /app

COPY ./build/output/ExamService-SNAPSHOT.jar .

ARG MONGO_URI
ENV MONGO_URI="-Dmongo_uri=${MONGO_URI}"

ARG EXAM_PORT
ENV EXAM_PORT="-Dexam_port=${EXAM_PORT}"

ARG DOSSIER_SERVICE_HOST=localhost
ENV DOSSIER_HOST_ARG="-Ddossier_host=${DOSSIER_SERVICE_HOST}"

ARG DOSSIER_SERVICE_PORT
ENV DOSSIER_SERVICE_PORT="-Ddossier_port=${DOSSIER_SERVICE_PORT}"

ARG DRIVING_SERVICE_HOST=localhost
ENV DRIVING_HOST_ARG="-Ddriving_host=${DRIVING_SERVICE_HOST}"

ARG DRIVING_SERVICE_PORT
ENV DRIVING_SERVICE_PORT="-Ddriving_port=${DRIVING_SERVICE_PORT}"


CMD java $MONGO_URI $EXAM_PORT $DOSSIER_HOST_ARG $DOSSIER_SERVICE_PORT $DRIVING_HOST_ARG $DRIVING_SERVICE_PORT -jar ExamService-SNAPSHOT.jar